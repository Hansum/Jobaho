{"ast":null,"code":"const cheerio = require(\"cheerio\");\n\nconst axios = require(\"axios\");\n\nconst filterJobs = async () => {\n  const arr = await getRemainingData();\n  const keywords = [\"Associate\", \"Entry-level\", \"Junior\", \"Jr\", \"Fresh\", \"Fresh-Graduate\", \"Senior\", \"Sr\"];\n  const arrKeywordsFinal = [];\n\n  if (arr != 0 || arr != undefined) {\n    for (let item of arr) {\n      const exists = keywords.some(res => item.Job_Position.includes(res));\n\n      if (!exists) {\n        arrKeywordsFinal.push(item);\n      }\n    }\n\n    return arrKeywordsFinal;\n  } else {\n    console.log(\"no array found to check Keywords\");\n  }\n};\n\nconst FinalOutput = async () => {\n  const keyData = await filterJobs();\n  const finalData = [];\n\n  if (keyData) {\n    for (let item of keyData) {\n      if (item.Job_Position !== undefined && item.Company_Name !== undefined && item.Job_Date !== undefined && item.Job_url !== undefined) {\n        const jobTitle = item.Job_Position.trim();\n        const company = item.Company_Name.trim();\n        const date = item.Job_Date.trim();\n        const location = item.Job_Location.trim();\n        finalData.push({\n          Job_Position: jobTitle,\n          Company_Name: company,\n          Job_Location: location,\n          Job_Date: date,\n          Job_Url: item.Job_url\n        });\n      }\n    }\n\n    return finalData;\n  } else {\n    console.log(\"no array found to remove space\");\n  }\n};\n\nasync function getRemainingData() {\n  const position_title = [];\n  const company_name = [];\n  const date = [];\n  const job_Url = [];\n  const location = [];\n  const finalArray = [];\n  const url = \"https://www.cebuitjobs.com\";\n\n  for (let i = 0; i !== 143; i += 13) {\n    await axios.get(url + `/more/${i}`).then(function (res) {\n      const $ = cheerio.load(res.data);\n      $('div[class=\"card-body\"]').each(function (index, element) {\n        if ($(element).find(\"img\").length === 1) {\n          $(element).find(\"h5\").each(function (index, job) {\n            position_title.push($(job).text());\n          });\n          $(element).find(\"img\").each(function (index, company) {\n            company_name.push($(company).attr(\"alt\"));\n          });\n          $(element).find(\"h6\").each(function (index, jobDate) {\n            date.push($(jobDate).text());\n          });\n          $(element).find(\"span:first-of-type\").each(function (index, jobLocation) {\n            location.push($(jobLocation).text());\n          });\n          $(element).find(\"h5 a\").each(function (index, url) {\n            job_Url.push($(url).attr(\"href\"));\n          });\n        }\n      });\n    }).catch(function (err) {\n      console.log(\"Error fetching\", err);\n    });\n  }\n\n  for (let i = 0; i <= position_title.length; i++) {\n    if (position_title[i] !== undefined && company_name[i] !== undefined && date[i] !== undefined && job_Url[i] !== undefined) {\n      finalArray.push({\n        Job_Position: position_title[i],\n        Company_Name: company_name[i],\n        Job_Location: location[i],\n        Job_Date: date[i],\n        Job_url: job_Url[i]\n      });\n    }\n  } // console.log(\"array:\", finalArray);\n\n\n  return axios.all(finalArray).then(res => {\n    return res;\n  });\n}\n\nconst sendScrapeData = async () => {\n  const mid_level = await FinalOutput();\n  const length = mid_level.length;\n  return {\n    mid_level,\n    length\n  };\n};\n\nmodule.exports = sendScrapeData;","map":null,"metadata":{},"sourceType":"script"}